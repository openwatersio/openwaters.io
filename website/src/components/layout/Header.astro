---
import Search from "astro-pagefind/components/Search";

const navItems = [
  { name: "About", href: "/about" },
  { name: "Tides", href: "/tides" },
  { name: "Bathymetry", href: "/bathymetry" },
  { name: "API", href: "/api" },
];

const currentPath = Astro.url.pathname;
---

<header class="sticky top-0 z-50 border-b border-navy-100 bg-white">
  <nav class="container-custom py-4">
    <div class="flex items-center justify-between">
      <!-- Logo -->
      <a
        href="/"
        class="flex items-center gap-2 text-2xl font-bold text-navy-900 transition-colors hover:text-ocean-600"
      >
        <svg
          class="h-8 w-8"
          viewBox="0 0 24 24"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"
            fill="currentColor"
            class="text-ocean-600"></path>
          <path
            d="M12 6c-3.31 0-6 2.69-6 6s2.69 6 6 6 6-2.69 6-6-2.69-6-6-6zm0 10c-2.21 0-4-1.79-4-4s1.79-4 4-4 4 1.79 4 4-1.79 4-4 4z"
            fill="currentColor"
            class="text-ocean-400"></path>
        </svg>
        <span>Open Waters</span>
      </a>

      <!-- Desktop Navigation -->
      <ul class="hidden items-center gap-8 md:flex">
        {
          navItems.map((item) => (
            <li>
              <a
                href={item.href}
                class={`font-medium transition-colors ${
                  currentPath.startsWith(item.href)
                    ? "text-ocean-600"
                    : "text-navy-700 hover:text-ocean-600"
                }`}
              >
                {item.name}
              </a>
            </li>
          ))
        }
      </ul>

      <div class="hidden md:block">
        <Search />
      </div>

      <!-- Mobile Menu Button -->
      <button
        id="mobile-menu-button"
        class="rounded p-2 text-navy-700 hover:text-ocean-600 focus:outline-none focus:ring-2 focus:ring-ocean-500 md:hidden"
        aria-label="Toggle menu"
        aria-expanded="false"
      >
        <svg
          class="h-6 w-6"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M4 6h16M4 12h16M4 18h16"></path>
        </svg>
      </button>
    </div>

    <!-- Mobile Navigation -->
    <div id="mobile-menu" class="mt-4 hidden pb-4 md:hidden">
      <ul class="space-y-2">
        {
          navItems.map((item) => (
            <li>
              <a
                href={item.href}
                class={`block rounded-lg px-4 py-2 font-medium transition-colors ${
                  currentPath.startsWith(item.href)
                    ? "bg-ocean-50 text-ocean-600"
                    : "text-navy-700 hover:bg-navy-50"
                }`}
              >
                {item.name}
              </a>
            </li>
          ))
        }
      </ul>
    </div>
  </nav>
</header>

<script>
  const button = document.getElementById("mobile-menu-button");
  const menu = document.getElementById("mobile-menu");

  button?.addEventListener("click", () => {
    const isExpanded = button.getAttribute("aria-expanded") === "true";
    button.setAttribute("aria-expanded", (!isExpanded).toString());
    menu?.classList.toggle("hidden");
  });
</script>
